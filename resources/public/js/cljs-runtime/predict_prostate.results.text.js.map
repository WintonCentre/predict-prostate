{"version":3,"sources":["predict_prostate/results/text.cljs"],"mappings":"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","names":["predict-prostate.results.text/round","js/Math.round","predict-prostate.results.text/set-default","key","state","default","predict-prostate.state.config/get-input-default","predict-prostate.state.config/input-groups","pubsub.feeds/publish","predict-prostate.state.run-time/input-change","predict-prostate.results.text/emph","n","rum.core/build-defc","js/React.createElement","attrs47367","cljs.core.apply","cljs.core/map?","sablono.interpreter/attributes","sablono.interpreter/interpret","attrs47368","predict-prostate.results.text/texts","rum.core/static","years","data","radical?","printable","ttt","cs","G__47365","cljs.core.nth","rs","G__47366","benefit","predict-prostate.components.button/year-picker","predict-prostate.results.text/extract-data","results","p1__47369#","p2__47370#","one-sum","radical-survival","cljs.core.map","cljs.core.get_in","conservative-survival","p1__47371#","p2__47372#","p1__47373#","p__47424","map__47429","cljs.core/PROTOCOL_SENTINEL","cljs.core/hash-map","cljs.core.get","attrs47408","predict-prostate.results.text/results-in-text","rum.core/reactive","year","rum.core/react","predict-prostate.state.run-time/input-cursor","cljs.core._EQ_","predict-prostate.state.run-time/results-cursor","text1","text2","G__47441","G__47453","G__47451","G__47456"],"sourcesContent":["(ns predict-prostate.results.text\n  (:require [rum.core :as rum]\n            [predict-prostate.components.helpful-form-groups :refer [form-entry]]\n            [predict-prostate.state.config :refer [input-groups get-input-default]]\n            [predict-prostate.components.button :refer [year-picker]]\n            [predict-prostate.state.run-time :refer [input-change input-cursor results-cursor]]\n            [predict-prostate.results.util :refer [fill avoid-decimals]]\n            [graphics.simple-icons :refer [icon]]\n            [pubsub.feeds :refer [publish]]))\n\n\n(def round js/Math.round)\n\n(defn set-default [key]\n  \"Set the default state of an input after it is mounted. Use this on tab switching if something has to go back to default.\"\n  {:did-mount (fn [state]\n                (let [default (get-input-default input-groups key)]\n                  (publish (input-change key) default))\n                state)})\n\n(defn emph [n]\n  (if false\n    [:span {:style {:font-size \"16px\" :font-weight \"bold\"}} n]\n    n))\n\n(rum/defc texts < rum/static [years data radical? printable ttt]\n  (let [cs (round (nth (:conservative-survival data) years))\n        rs (round (nth (:radical-survival data) years))\n        benefit (- rs cs)]\n    [:.row\n     [:.print-only\n      [:.col-sm-12.print-only {:style {:margin-top 0 :margin-bottom \"0px\" :display \"inline-block\" :font-size 12}}\n       \"Based on the information you have entered, \"\n       [:p (emph cs) \" out of \" (emph 100) \" men are alive at years with \" (emph \"initial conservative manage,ent\") \".\"]\n\n       (when radical?\n         [:p (emph rs) \" out of \" (emph 100) \" men treated (an extra \" (emph benefit) \") are alive because of \" (emph \"radical treatment\") \".\"])]]\n\n     [:.screen-only\n      [:.col-sm-12 {:style {:margin-top 15 :margin-bottom \"0px\" :display \"inline-block\" :font-size 16}}\n       [:span \"Based on the information you have entered, \" (year-picker ttt) \" years after diagnosis:\"]\n\n       [:p (emph cs) \" out of \" (emph 100) \" men are alive at \" years \" years with \" (emph \"initial conservative treatment\") \".\"]\n\n       (when radical?\n         [:p (emph rs) \" out of \" (emph 100) \" men treated (an extra \" (emph benefit) \") are alive because of \" (emph \"radical treatment\") \".\"])]]]))\n\n\n(defn extract-data\n  \"Different models use different treatment widgets, so we need to use these to react to the correct\n  treatments and lookup the appropriate result-data.\"\n\n  [results radical?]\n  (let [one-sum #(* 100 (- 1 (+ %1 %2)))\n        radical-survival (map one-sum\n                              (get-in results [:radical :pred-PC-cum])\n                              (get-in results [:radical :pred-NPC-cum]))\n        conservative-survival (map one-sum\n                                   (get-in results [:conservative :pred-PC-cum])\n                                   (get-in results [:conservative :pred-NPC-cum]))]\n    {:title                 \"Overall Survival\"\n     :subtitle-over         \"for men with prostate cancer, 5 and 10 years after diagnosis\"\n     :subtitle-under        \"years after diagnosis\"\n     :conservative-survival conservative-survival\n     :radical-survival      radical-survival\n     :radical-benefit       (map #(- %1 %2) radical-survival conservative-survival)\n     :dotted-orange         (map #(* 100 (- 1 %)) (get-in results [(if radical? :radical :conservative) :NPC-survival #_:pred-NPC-cum]))\n     }\n    ))\n\n(rum/defc results-in-text < rum/reactive #_(set-default :result-year)\n  [{:keys [printable ttt]}]\n  (let [year (rum/react (input-cursor :result-year))\n        radical? (= 1 (rum/react (input-cursor :primary-rx)))\n        data (extract-data (rum/react results-cursor) radical?)\n        text1 \"Of the men who would not survive, \"\n        text2 \" would die due to causes not related to prostate cancer.\"\n        ]\n\n    [:div\n     (texts year data radical? printable ttt)\n     [:p.print-only {:style {:font-size 12}} text1 (emph (round (nth (:dotted-orange data) year))) text2]\n     [:p.screen-only {:style {:font-size 16}} text1 (emph (round (nth (:dotted-orange data) year))) text2]]))"]}