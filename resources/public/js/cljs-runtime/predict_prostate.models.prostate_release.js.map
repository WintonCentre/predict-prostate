{"version":3,"sources":["predict_prostate/models/prostate_release.cljs"],"mappings":"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","names":["predict-prostate.models.prostate-release/exp","js/Math.exp","predict-prostate.models.prostate-release/ln","js/Math.log","predict-prostate.models.prostate-release/pow","js/Math.pow","predict-prostate.models.prostate-release/abs","js/Math.abs","p__43205","map__43206","cljs.core/PROTOCOL_SENTINEL","cljs.core.apply","cljs.core/hash-map","cljs.core.get","predict-prostate.models.prostate-release/pi-pcsm","age","psa","t-stage","grade-group","primary-rx","brca","biopsy50","biopsy-done","biopsy-cores-involved","biopsy-cores-taken","inputs","ppc","and__4115__auto__","cljs.core._EQ_","G__43214","G__43215","G__43216","js/Math.sqrt","p__43222","map__43223","predict-prostate.models.prostate-release/pi-npcm","charlson-comorbidity","predict-prostate.models.prostate-release/days","t","predict-prostate.models.prostate-release/pcsm-at-t","time","pi","G__43228","G__43229","p__43239","map__43240","predict-prostate.models.prostate-release/f","n","a","b","c","foo","predict-prostate.models.prostate-release/npcm-at-t","G__43272","G__43273","p__43297","map__43298","predict-prostate.models.prostate-release/run-prostate","protect","args","piPCSM","piNPCM","PCSMatT","p1__43274#","cljs.core.map","cljs.core.range","PCSM-mortrate-year","common.utils/deltas","PCS-survival-year","p1__43275#","NPCMatT","p1__43276#","NPCM-mortrate-year","NPC-survival-year","p1__43277#","PCSsurvival","p1__43278#","NPCsurvival","p1__43282#","allcauseM","p1__43283#","p2__43284#","allcauseM-inyear","proportionPC-cum","p1__43285#","p2__43286#","proportionPC","p1__43287#","p2__43288#","propn-NPC","p1__43289#","pred-PC-year","p1__43290#","p2__43291#","pred-PC-cum","cljs.core.reductions","cljs.core/+","pred-NPC-year","p1__43292#","p2__43293#","pred-NPC-cum","overall-survival","p1__43294#","p2__43295#","NPCM","p1__43296#","cljs.core/PersistentArrayMap","cljs.core/cons"],"sourcesContent":["(ns predict-prostate.models.prostate-release\n  (:require [common.data-frame :refer [cell-apply cell-update cell-sums cell-diffs]]\n            [common.utils :refer [deltas]]\n            ))\n\n(def exp js/Math.exp)\n(def ln js/Math.log)\n(def pow js/Math.pow)\n(def abs js/Math.abs)\n\n\n; stata L 21\n(defn pi-pcsm [{:keys [age psa t-stage grade-group primary-rx brca biopsy50 biopsy-done biopsy-cores-involved biopsy-cores-taken] :as inputs}]\n  \"gen pi-pcsm = 0.0026005*((age/10)^3-341.155151) + 0.185959*(ln((psa+1)/100)+1.636423432) + .1614922*(t_stage==2) + .39767881*(t_stage==3) + .6330977*(t_stage==4) + .2791641*(gradegroup==2) + .5464889*(gradegroup==3) + .7411321*(gradegroup==4) + 1.367963*(gradegroup==5) + -.6837094*(primaryRx==1) + .9084921*(primaryRx==3) -0.617722958*(biopsy50==1) + 0.579225231*(biopsy50==2) +(((PPC+0.1811159)/100)^.5-.649019)*1.890134 \\n\"\n  (let [ppc (if (and biopsy-cores-involved biopsy-cores-taken (= 1 biopsy-done))\n              (* 100 (/ biopsy-cores-involved biopsy-cores-taken))\n              41.9415)]\n\n    ;(println \"inputs = \" inputs)\n\n    (+ (* 0.0026005 (- (pow (/ age 10) 3) 341.155151))\n      (* 0.185959 (+ (ln (/ (inc psa) 100)) 1.636423432))\n      (get {1 0\n            2 0.1614922\n            3 0.39767881\n            4 0.6330977} t-stage)\n      (get {1 0\n            2 0.2791641\n            3 0.5464889\n            4 0.7411321\n            5 1.367963} grade-group)\n      (get {0.9 (ln 0.35)                                   ; radical low (now log 0.38) (was log 0.35)  ;todo uncertainty\n            1   -0.6837094\n            1.1 (ln 0.67)                                   ; radical high (now log 0.67) (was log 0.67) ;todo uncertainty\n            3   0.9084921} primary-rx)\n      #_(get {1 -0.617722958\n            2 0.579225231} biopsy50)\n      (get {nil 0\n            0 0\n            1 0.956\n            2 0} brca)\n      (* (- (js/Math.sqrt (/ (+ ppc 0.1811159) 100)) 0.649019) 1.890134)\n      )\n\n\n    ))\n(comment\n  (pi-pcsm {:age 70 :psa 10 :t-stage 2 :grade-group 2 :primary-rx 0  :biopsy50 0 :brca 0 :ppc 41.9415})\n  ;=> 0.3392995824130641\n  )\n\n(defn pi-npcm [{:keys [age charlson-comorbidity]}]\n  \"gen pi-npcm = 0.1229245*(age-69.8749646) + 0.6640308*(charlson_comorbidity==1)\"\n  (+ (* 0.1226666 (- age 69.87427439))\n     (get {0 0\n           1 0.6382002} charlson-comorbidity))\n  )\n(comment\n  (pi-npcm {:age 70 :charlson-comorbidity 0})\n  ; => 0.015422333111626427\n  )\n\n\n; using 'days' instead of 'time' so as not to shadow the clojure 'time' function\n(defn days [t] (* 365 t))\n\n#_(comment\n    ; generate baseline mortality (though I don't go on to use this!?)\n    ; ok to bind 'time' to a local\n    (defn bs-PCSM [time]\n      \"exp(-17.03262 + 1311.891*(time^-2) + 1.726887*(ln(time)))\"\n      (exp (+ -17.03262\n              (* 1311.891 (pow time -2))\n              (* 1.726887 (ln time))))\n      )\n    (comment\n      (bs-PCSM (days 10))\n      ;=> 0.05682600500436472 (year 10)\n      )\n\n    (defn bs-NPCM [time]\n      \"exp(-12.45735 + 1.317565*(ln(time)) + 3.01e-12*(time^3))\"\n      (exp (+ -12.45735\n              (* 1.317565 (ln time))\n              (* 3.01e-12 (pow time 3))))\n      )\n    (comment\n      (bs-NPCM (days 10))\n      ;=> 0.22231086828716715 (year 10)\n      ))\n\n\n;gen PCS mortality, then per year, then convert to survival per year...\n(defn pcsm-at-t [time pi]\n  \"1 - exp(-exp(pi-pcsm)*exp(-17.03262 + 1311.891*(time^-2) + 1.726887*(ln(time))))\"\n  (+ 1\n     (- (exp (* (- (exp pi))\n                (exp (+ -16.40532\n                        (* 1.653947 (ln time))\n                        (* 1.89e-12 (pow time 3)))))))))\n(comment\n  (pcsm-at-t (days 10)))\n\n(defn f [{:keys [n a b c]\n          :or   {c 3 n 10}\n          :as   foo}]\n  [foo c n])\n\n\n(defn npcm-at-t [time pi]\n  \"1 - exp(-exp(piNPCM)*exp(-12.45735 + 1.317565*(ln(time)) + 3.01e-12*(time^3)))\"\n  (+ 1\n     (- (exp (* (- (exp pi))\n                (exp (+ -12.4841\n                        (* 1.32274 (ln time))\n                        (* 2.90e-12 (pow time 3)))))))))    ; 3.01e-12 !!!!\n\n(defn run-prostate [{:keys [n age grade-group psa t-stage charlson-comorbidity primary-rx protect biopsy50]\n                     :as   args}]\n\n  (let [;defaults {:n 10 :age 45 :grade-group 5 :psa 85 :t-stage 3 :charlson-comorbidity 1 :primary-rx 0 :protect 0 :biopsy50 0}\n\n\n\n        ;calculate the PCSM prognostic index (pi)\n        piPCSM (pi-pcsm args)\n        ; 1.4757039089297683\n\n        ;calculate the NPCM progostic index (pi)\n        piNPCM (pi-npcm args)\n        ;-3.0577425859727\n\n        ;\n        ; gen PCS mortality, then per year, then convert to survival per year... L 36\n        ;\n        PCSMatT (map #(pcsm-at-t (days %) piPCSM) (range 1 (inc n)))\n        ; (0.004696368826957453 0.015348535722248369 0.030632249443662052 0.049821202973259204 0.0723622401089552 0.09778069760891961 0.1256472677385151 0.1555640347706816 0.1871582391504335 0.22007959169657776)\n\n        PCSM-mortrate-year (deltas 0 PCSMatT)\n        ; [0.004696368826957453 0.010652166895290915 0.015283713721413683 0.019188953529597153 0.022541037135695996 0.02541845749996441 0.02786657012959548 0.029916767032166502 0.03159420437975191 0.032921352546144256]\n\n        PCS-survival-year (map #(- 1 %) PCSM-mortrate-year)\n        ; (0.9953036311730425 0.9893478331047091 0.9847162862785863 0.9808110464704028 0.977458962864304 0.9745815425000356 0.9721334298704045 0.9700832329678335 0.9684057956202481 0.9670786474538557)\n\n        ;\n        ; do the same for NPCM... L 49\n        ;\n        NPCMatT (map #(npcm-at-t (days %) piNPCM) (range 1 (inc n)))\n        ; (0.0008435940967794764 0.0021034450705306185 0.003596050109458959 0.005277474404832394 0.007138103010569274 0.009188519090954417 0.011455884009952233 0.013983784428835522 0.016834044593207587 0.02009025121514263)\n\n        NPCM-mortrate-year (deltas 0 NPCMatT)\n        ; [0.0008435940967794764 0.001259850973751142 0.0014926050389283407 0.0016814242953734349 0.0018606286057368804 0.0020504160803851423 0.0022673649189978162 0.0025279004188832888 0.002850260164372065 0.0032562066219350427]\n\n        NPC-survival-year (map #(- 1 %) NPCM-mortrate-year)\n        ; (0.9991564059032205 0.9987401490262489 0.9985073949610717 0.9983185757046266 0.9981393713942631 0.9979495839196149 0.9977326350810022 0.9974720995811167 0.9971497398356279 0.996743793378065)\n\n        ;\n        ;generate survivals\n        ;\n        PCSsurvival (map #(- 1 %) PCSMatT)\n        ;(0.9953036311730425 0.9846514642777516 0.969367750556338 0.9501787970267408 0.9276377598910448 0.9022193023910804 0.8743527322614849 0.8444359652293184 0.8128417608495665 0.7799204083034222)\n\n        NPCsurvival (map #(- 1 %) NPCMatT)\n        ;(0.9991564059032205 0.9978965549294694 0.996403949890541 0.9947225255951676 0.9928618969894307 0.9908114809090456 0.9885441159900478 0.9860162155711645 0.9831659554067924 0.9799097487848574)\n\n        ;\n        ;'all cause mortality'\n        ;\n        allcauseM (map #(- 1 (* %1 %2)) PCSsurvival NPCsurvival)\n        ;(0.005535976336812465 0.01741962778769468 0.03411802269051689 0.05483556505613563 0.0789835662715267 0.1060704395470139 0.1356633605530203 0.16737197747451704 0.20084110431861169 0.23574775252364877)\n\n        allcauseM-inyear (deltas 0 allcauseM)\n        ; [0.005535976336812465 0.011883651450882216 0.01669839490282221 0.020717542365618735 0.02414800121539107 0.0270868732754872 0.029592921006006412 0.031708616921496735 0.03346912684409464 0.03490664820503708]\n\n        ;\n        ; proportion of all cause mortality\n        ;\n        proportionPC-cum (map #(/ %1 (+ %1 %2)) PCSMatT NPCMatT)\n        ;(0.847729484591698 0.8794759072130388 0.8949425549607571 0.9042209129145304 0.9102159857565977 0.914104283009165 0.9164463078642722 0.9175260631086086 0.9174800914362404 0.9163529292704825)\n\n        proportionPC (map #(/ %1 (+ %1 %2)) PCSM-mortrate-year NPCM-mortrate-year)\n        ;(0.847729484591698 0.8942403133741444 0.9110321082436409 0.9194378035322059 0.9237527851534536 0.9253577797910928 0.9247600090270526 0.9220888423039323 0.9172538025684129 0.9099972624769542)\n\n        ; this makes more sense to me, but the prostate code (line 121) suggests this should be*allcauseM_inyear ??why??\n        propn-NPC (map #(- 1 %) proportionPC)\n        ;(0.15227432175853584 0.10576301912922303 0.08897095127071308 0.0805651104869638 0.07625006528048706 0.07464507324581204 0.07524290854617943 0.07791420339558741 0.08274944035552734 0.0900062551706945)\n\n        ;\n        ; *PC mortality as competing risk\n        ;\n        pred-PC-year (map #(* %1 %2) proportionPC allcauseM-inyear)\n        ;(0.004693010282765466 0.01062683944561739 0.015212771614112598 0.01904848684638193 0.022306775075572483 0.02506503606101867 0.027366331363946138 0.029238136411749632 0.03069965006915814 0.03176491052736049)\n\n        pred-PC-cum (reductions + pred-PC-year)\n        ;(0.004693010282765466 0.015319849728382854 0.03053262134249545 0.049581108188877385 0.07188788326444986 0.09695291932546854 0.12431925068941468 0.15355738710116432 0.18425703717032246 0.21602194769768296)\n\n        ;\n        ; *NPC Mortality as competing risk\n        ;\n        pred-NPC-year (map #(* %1 %2) propn-NPC allcauseM-inyear)\n        ; (0.0008429908119527243 0.001256855450638569 0.001485676844069427 0.0016691159590441862 0.0018412916653964386 0.0020219068365977025 0.00222666296597377 0.0024705576375669007 0.002769558258234278 0.0031418245000532172)\n\n        pred-NPC-cum (reductions + pred-NPC-year)\n        ; (0.0008429908119527243 0.002099846262591293 0.0035855231066607204 0.005254639065704907 0.0070959307311013456 0.009117837567699048 0.011344500533672818 0.013815058171239718 0.016584616429473995 0.01972644092952721)\n\n        overall-survival (map #(* 100 (- 1 (+ %1 %2))) pred-NPC-cum pred-PC-cum)\n        ; (99.44639989052818 98.25803040090258 96.58818555508438 94.51642527454177 92.10161860044488 89.39292431068324 86.43362487769124 83.2627554727596 79.91583464002035 76.42516113727899)\n        NPCM (map #(- 100 (* % 100)) pred-PC-cum)\n        ; (99.53069897172345 98.46801502716171 96.94673786575045 95.04188918111227 92.81121167355501 90.30470806745315 87.56807493105853 84.64426128988357 81.57429628296775 78.39780523023171)\n        ]\n    (array-map\n      ;; unused\n      ;:piPCSM piPCSM\n      ;:piNPCM piNPCM\n      ;:PCSMatT (map #(pcsm-at-t (days %) piPCSM) (range 1 16))\n      ;:PCSM_mortrate_year PCSM-mortrate-year\n      ;:NPCMatT NPCMatT\n      ;:NPCM-mortrate-year NPCM-mortrate-year\n      ;:NPCsurvival NPCsurvival\n      :PCSsurvival PCSsurvival\n\n      ;; used\n      :pred-PC-cum (cons 0 pred-PC-cum)\n      :pred-NPC-cum (cons 0 pred-NPC-cum)\n      :NPC-survival (cons 1 NPCsurvival)\n      )\n\n    )\n  )\n\n(comment\n\n  (run-prostate {:n                    15\n                 :age                  65\n                 :grade-group          4\n                 :psa                  11\n                 :t-stage              2\n                 :charlson-comorbidity 0\n                 :primary-rx           0\n                 :biopsy50             0\n                 })\n\n  (run-prostate {:n                    15\n                 :age                  65\n                 :grade-group          4\n                 :psa                  11\n                 :t-stage              2\n                 :charlson-comorbidity 1\n                 :primary-rx           0\n                 :biopsy50             0\n                 })\n\n  (run-prostate {:n                    15\n                 :age                  65\n                 :grade-group          4\n                 :psa                  11\n                 :t-stage              2\n                 :charlson-comorbidity 1\n                 :primary-rx           1\n                 :biopsy50             0\n                 })\n\n  (run-prostate {:n                    15\n                 :age                  65\n                 :grade-group          4\n                 :psa                  11\n                 :t-stage              2\n                 :charlson-comorbidity 1\n                 :primary-rx           1\n                 :biopsy50             1\n                 })\n\n  (run-prostate {:n                    15\n                 :age                  95\n                 :grade-group          4\n                 :psa                  10\n                 :t-stage              3\n                 :charlson-comorbidity 0\n                 :primary-rx           1\n                 :biopsy50             2\n                 })\n  )"]}